var headline_envy_admin=headline_envy_admin||{};!function(a,b){"use strict";b.event=b.event||{},b.init=function(){this.edited_titles=!1,this.experiment_titles=this.experiment_titles||[],this.$title_container=a(document.getElementById("he-titles")),this.$add_button=this.$title_container.find(".add-title"),this.title_template=a(document.getElementById("he-title-template")).html(),a(document).on("click","#he-titles .add-title",function(){b.add_title(),this.edited_titles=!0}),a(document).on("click","#he-titles .dashicons-dismiss",function(c){c.preventDefault(),b.remove_title(a(this).closest(".he-title"),!0),this.edited_titles=!0}),a(document).on("click","#he-titles .select-title",function(){var b=a(this).closest(".he-container");b.addClass("title-select")}),a(document).on("click","#he-titles .cancel-select-title",function(){var b=a(this).closest(".he-container");b.removeClass("title-select"),b.find('[name="he-winner"]:checked').prop("checked",!1)}),a(document).on("keydown",'#he-titles input[type="text"]',function(){b.edited_titles=!0}),a(document).on("click","#publish",function(){b.edited_titles&&a("body").addClass("saving-post")}),a(document).on("change",".experiment-options select",function(){var b=a(this),c=b.val(),d=b.closest(".headline-results").find(".experiment-results");d.find("table").hide(),d.find('table[data-goal="'+c+'"]').css("display","table")}),this.load_experiment()},b.add_title=function(b){b=b||{};var c=a(this.title_template),d=this.$title_container.find(".he-title");b.num=b.num||d.length+1,b.id=b.id||"he-title-"+b.num,b.improvement=b.improvement||"0%",b.conversion_rate=b.conversion_rate||"0%",c.attr("data-variation",b.variation||"").attr("data-winner",b.winner||"false"),c.find('input[type="text"]').attr("id",b.id).attr("name","headline_envy_title["+b.num+"]").val(b.value||""),c.find('input[type="radio"]').val(b.variation||""),c.find("label").attr("for",b.id),c.find(".he-status").attr("title",b.improvement+" Improvement, "+b.conversion_rate+" Conversion Rate").text(b.improvement),this.$add_button.before(c),a(document).trigger("headline-envy-add-title")},b.remove_title=function(b,c){var d=a.trim(b.find("input").val()),e=!0;d&&c&&(e=confirm('Are you sure you want to remove: "'+d+'"?')),e&&(b.remove(),a(document).trigger("headline-envy-remove-title"))},b.load_experiment=function(){for(var b in this.experiment_titles)this.add_title(this.experiment_titles[b]);var c=a("<input>",{name:"headline_envy_titles_loaded",type:"hidden",value:"true"});this.$title_container.after(c)},a(function(){b.init()})}(jQuery,headline_envy_admin);