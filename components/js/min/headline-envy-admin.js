var headline_envy_admin=headline_envy_admin||{};!function(a,b){"use strict";b.event=b.event||{};var c=a(document);b.init=function(){this.edited_titles=!1,this.experiment_titles=this.experiment_titles||[],this.$title_container=a(document.getElementById("he-titles")),this.$add_button=this.$title_container.find(".add-title"),this.title_template=a(document.getElementById("he-title-template")).html(),c.on("click","#he-titles .add-title",function(){b.add_title(),b.edited_titles=!0}),c.on("click","#he-titles .dashicons-dismiss",function(c){c.preventDefault(),b.remove_title(a(this).closest(".he-title"),!0),b.edited_titles=!0}),c.on("click","#he-titles .select-title",function(){var b=a(this).closest(".he-container");b.addClass("title-select")}),c.on("click","#he-titles .cancel-select-title",function(){var b=a(this).closest(".he-container");b.removeClass("title-select"),b.find('[name="he-winner"]:checked').prop("checked",!1)}),c.on("keydown",'#he-titles input[type="text"]',function(){b.edited_titles=!0}),c.on("click","#publish",function(){b.edited_titles&&a("body").addClass("saving-post")}),c.on("change",".experiment-options select",function(){var c=a(this),d=c.val(),e=c.closest(".headline-results").find(".experiment-results");e.find("table").hide(),e.find('table[data-goal="'+d+'"]').css("display","table")}),this.load_experiment()},b.add_title=function(b){b=b||{};var d=a(this.title_template),e=this.$title_container.find(".he-title");b.num=b.num||e.length+1,b.id=b.id||"he-title-"+b.num,b.improvement=b.improvement||"0%",b.conversion_rate=b.conversion_rate||"0%",d.attr("data-variation",b.variation||"").attr("data-winner",b.winner||"false"),d.find('input[type="text"]').attr("id",b.id).attr("name","headline_envy_title["+b.num+"]").val(b.value||""),d.find('input[type="radio"]').val(b.variation||""),d.find("label").attr("for",b.id),d.find(".he-status").attr("title",b.improvement+" Improvement, "+b.conversion_rate+" Conversion rate").text(b.improvement),this.$add_button.before(d),c.trigger("headline-envy-add-title")},b.remove_title=function(b,d){var e=a.trim(b.find("input").val()),f=a.trim(b.find('input[type="text"]').val()),g=!0;e&&d&&(g=confirm('Are you sure you want to remove: "'+f+'"?')),g&&(b.remove(),c.trigger("headline-envy-remove-title"))},b.load_experiment=function(){for(var b in this.experiment_titles)this.experiment_titles.hasOwnProperty(b)&&this.add_title(this.experiment_titles[b]);var c=a("<input>",{name:"headline_envy_titles_loaded",type:"hidden",value:"true"});this.$title_container.after(c)},a(function(){b.init()})}(jQuery,headline_envy_admin);
